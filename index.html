<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω V·∫≠t T∆∞</title>
    <link rel="icon" type="image/png" href="https://images.seeklogo.com/logo-png/50/1/johnson-johnson-logo-png_seeklogo-500414.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .modal-backdrop { background-color: rgba(0, 0, 0, 0.5); }
        .nav-button.active { background-color: #374151; color: #f3f4f6; }
        button, .nav-button, .cursor-pointer {
            transition: all 0.2s ease-in-out;
        }
        button:not(:disabled):active, .nav-button:active {
            transform: scale(0.97);
        }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .table-container { height: calc(100vh - 250px); overflow-y: auto; }
        .table-container thead th { 
            position: sticky; 
            top: 0; 
            z-index: 10; 
            background-color: #E5E7EB; /* <-- FIX: Th√™m d√≤ng n√†y (ƒê√¢y l√† m√†u bg-gray-200 c·ªßa Tailwind) */
        }
        
        #toast-container {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }
        .toast {
            display: flex;
            align-items: center;
            padding: 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            color: white;
            opacity: 0;
            transform: translateX(100%);
            transition: all 0.3s ease-in-out;
        }
        .toast.show { opacity: 1; transform: translateX(0); }
        .toast.hide { opacity: 0; transform: translateX(100%); }
        .toast-success { background-color: #28a745; }
        .toast-error { background-color: #dc3545; }
        .toast-info { background-color: #17a2b8; }

        .filter-popover {
            position: absolute;
            z-index: 40;
            background: white;
            border: 1px solid #ccc;
            border-radius: 6px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 8px;
            min-width: 250px;
        }
        .filter-options-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        @keyframes loading-bar-flow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        .animate-loading-bar-flow {
            width: 100%;
            position: absolute;
            animation: loading-bar-flow 1.5s infinite linear;
        }
        #loading-bar {
            background-color: #93c5fd; /* light blue */
            overflow: hidden;
        }
        .sortable-ghost {
            background: #c8ebfb;
            opacity: 0.5;
        }
        .sortable-drag {
            opacity: 1 !important;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .cursor-move {
            cursor: move;
        }
        /* Hide number input arrows */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
          -webkit-appearance: none;
          margin: 0;
        }
        input[type=number] {
          -moz-appearance: textfield; /* Firefox */
        }
    </style>
</head>
<body class="bg-gray-100 font-sans antialiased">

    <div id="loading-bar" class="fixed top-0 left-0 right-0 h-1 z-[9999] hidden">
        <div class="h-full bg-blue-500 animate-loading-bar-flow"></div>
    </div>

    <div id="toast-container"></div>

    <div id="main-app" class="hidden">
        <div class="flex h-screen bg-gray-200">
            <div id="sidebar" class="fixed inset-y-0 left-0 z-30 w-64 transform transition-all duration-300 ease-in-out bg-gray-900 text-gray-200 no-scrollbar overflow-y-auto flex flex-col">
                <div class="flex items-center justify-between p-4 border-b border-gray-700 flex-shrink-0">
                     <div id="user-details" class="flex items-center gap-3 transition-opacity duration-300">
                        <img id="sidebar-avatar" src="" alt="Avatar" class="w-10 h-10 rounded-full object-cover">
                        <div>
                            <span class="font-semibold text-base" id="user-ho-ten">ƒêang t·∫£i...</span>
                            <span class="text-xs text-gray-400 block" id="user-gmail">...</span>
                        </div>
                    </div>
                    <button id="sidebar-toggle-btn" class="p-2 rounded-full hover:bg-gray-700">
                        <svg id="sidebar-toggle-icon-close" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7"></path></svg>
                        <svg id="sidebar-toggle-icon-open" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5l7 7-7 7M5 5l7 7-7 7"></path></svg>
                    </button>
                </div>

                <nav class="mt-4 flex-grow">
                    <button data-view="view-phat-trien" class="nav-button w-full flex items-center px-6 py-3 text-gray-400 hover:bg-gray-700 active">
                        <svg class="w-6 h-6 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                        <span class="nav-text transition-opacity duration-300">T·ªïng Quan</span>
                    </button>
                    <button data-view="view-san-pham" class="nav-button w-full flex items-center px-6 py-3 text-gray-400 hover:bg-gray-700">
                         <svg class="w-6 h-6 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                        <span class="nav-text transition-opacity duration-300">S·∫£n Ph·∫©m</span>
                    </button>
                     <button data-view="view-ton-kho" class="nav-button w-full flex items-center px-6 py-3 text-gray-400 hover:bg-gray-700">
                        <svg class="w-6 h-6 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"></path></svg>
                        <span class="nav-text transition-opacity duration-300">T·ªìn Kho</span>
                    </button>
                    <button data-view="view-don-hang" class="nav-button w-full flex items-center px-6 py-3 text-gray-400 hover:bg-gray-700">
                        <svg class="w-6 h-6 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                        <span class="nav-text transition-opacity duration-300">ƒê∆°n H√†ng</span>
                    </button>
                     <button data-view="view-chi-tiet" class="nav-button w-full flex items-center px-6 py-3 text-gray-400 hover:bg-gray-700">
                        <svg class="w-6 h-6 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        <span class="nav-text transition-opacity duration-300">Chi Ti·∫øt</span>
                    </button>
                    <button data-view="view-cai-dat" class="nav-button w-full flex items-center px-6 py-3 text-gray-400 hover:bg-gray-700">
                         <svg class="w-6 h-6 mr-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0 3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path></svg>
                        <span class="nav-text transition-opacity duration-300">C√†i ƒê·∫∑t</span>
                    </button>
                </nav>

                <div id="sidebar-footer" class="p-4 text-center text-xs text-gray-400 flex-shrink-0 transition-opacity duration-300">
                    <p class="font-semibold">Phi√™n b·∫£n 001</p>
                    <p>Ph√°t tri·ªÉn b·ªüi Th√°i Trung T√≠n</p>
                    <p>Zalo: 0364605514</p>
                </div>
            </div>

            <div id="main-content-area" class="relative flex-1 flex flex-col ml-64 transition-all duration-300 ease-in-out">
                <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-100 p-4 md:p-6">
                    <div id="view-phat-trien" class="app-view flex items-center justify-center h-full">
                        <div class="text-center">
                            <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                                <path vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                            <h2 class="mt-2 text-2xl font-semibold text-gray-900">T√≠nh nƒÉng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn</h2>
                            <p class="mt-1 text-base text-gray-500">Ch∆∞a c√≥ √Ω t∆∞·ªüng cho ch·ª©c nƒÉng n√†y. Vui l√≤ng quay l·∫°i sau üòÖüòÄ!</p>
                        </div>
                    </div>
                    
                    <div id="view-san-pham" class="app-view hidden flex flex-col h-full">
                        <!-- Content will be loaded dynamically -->
                    </div>

                    <div id="view-ton-kho" class="app-view hidden flex flex-col h-full">
                        <div class="flex-shrink-0">
                            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Qu·∫£n L√Ω T·ªìn Kho</h1>
                            <div class="bg-white p-4 rounded-lg shadow-md mb-4">
                                <div class="flex flex-wrap gap-x-4 gap-y-2 items-center justify-between">
                                    <div class="flex flex-wrap gap-2 items-center">
                                        <input type="text" id="ton-kho-search" placeholder="T√¨m ki·∫øm chung..." class="px-3 py-2 border rounded-md w-48">
                                        <div class="relative"><button id="ton-kho-filter-ma-vt-btn" data-filter-key="ma_vt" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">M√£ VT</button></div>
                                        <div class="relative"><button id="ton-kho-filter-lot-btn" data-filter-key="lot" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">Lot</button></div>
                                        <div class="relative"><button id="ton-kho-filter-date-btn" data-filter-key="date" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">Date</button></div>
                                        <div class="relative"><button id="ton-kho-filter-ton-cuoi-btn" data-filter-key="ton_cuoi" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">T·ªìn Cu·ªëi</button></div>
                                        <div class="relative"><button id="ton-kho-filter-tinh-trang-btn" data-filter-key="tinh_trang" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">T√¨nh Tr·∫°ng</button></div>
                                        <div class="relative"><button id="ton-kho-filter-nganh-btn" data-filter-key="nganh" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">Ng√†nh</button></div>
                                        <div class="relative"><button id="ton-kho-filter-phu-trach-btn" data-filter-key="phu_trach" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">Ph·ª• Tr√°ch</button></div>
                                    </div>
                                    <div class="flex flex-wrap gap-2 items-center">
                                        <button id="ton-kho-reset-filters" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md">X√≥a L·ªçc</button>
                                        <button id="ton-kho-btn-add" class="tk-admin-only bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">+ Th√™m</button>
                                        <button id="ton-kho-btn-edit" class="tk-admin-only bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md" disabled>S·ª≠a</button>
                                        <button id="ton-kho-btn-delete" class="tk-admin-only bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md" disabled>X√≥a</button>
                                        <button id="ton-kho-btn-excel" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md">Excel</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-grow bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="table-container">
                                <table class="min-w-full border-collapse">
                                    <thead class="bg-gray-200"><tr>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 2%;"><input type="checkbox" id="ton-kho-select-all"></th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 15%;">M√£ V·∫°ch</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">M√£ VT</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 30%;">T√™n VT</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Lot</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Date</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">
                                            <div>ƒê·∫ßu<span id="ton-kho-header-dau-count" class="block font-bold text-black text-xs"></span></div>
                                        </th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">
                                            <div>Nh·∫≠p<span id="ton-kho-header-nhap-count" class="block font-bold text-green-600 text-xs"></span></div>
                                        </th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">
                                            <div>Xu·∫•t<span id="ton-kho-header-xuat-count" class="block font-bold text-red-600 text-xs"></span></div>
                                        </th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">
                                            <div>Cu·ªëi<span id="ton-kho-header-cuoi-count" class="block font-bold text-red-600 text-xs"></span></div>
                                        </th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">T.Tr·∫°ng</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">Tray</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">Ng√†nh</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 9%;">Ph·ª• Tr√°ch</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 1.5%;">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                                <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                            </svg>
                                        </th>
                                    </tr></thead>
                                    <tbody id="ton-kho-table-body" class="bg-white"></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="flex-shrink-0 flex flex-col md:flex-row justify-between items-center mt-4 p-4 bg-white rounded-lg shadow-md">
                            <span id="ton-kho-pagination-info" class="text-sm text-gray-600 mb-2 md:mb-0"></span>
                            <span id="ton-kho-selection-info" class="text-sm text-gray-600 mb-2 md:mb-0"></span>
                            <div class="flex items-center gap-2 flex-wrap">
                                <select id="ton-kho-items-per-page" class="px-3 py-1 border rounded-md bg-white">
                                    <option value="50">50 / trang</option>
                                    <option value="100">100 / trang</option>
                                    <option value="200">200 / trang</option>
                                    <option value="500">500 / trang</option>
                                </select>
                                <button id="ton-kho-prev-page" class="px-3 py-1 border rounded-md bg-white">Tr∆∞·ªõc</button>
                                <div class="flex items-center gap-1 mx-2">
                                    <span class="text-sm text-gray-700">Trang</span>
                                    <input type="number" id="ton-kho-page-input" class="w-16 text-center border rounded-md p-1 text-sm" value="1" min="1">
                                    <span id="ton-kho-total-pages" class="text-sm text-gray-700 whitespace-nowrap">/ 1</span>
                                </div>
                                <button id="ton-kho-next-page" class="px-3 py-1 border rounded-md bg-white">Sau</button>
                            </div>
                        </div>
                    </div>

                    <div id="view-don-hang" class="app-view hidden flex flex-col h-full">
                         <div class="flex-shrink-0">
                            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Qu·∫£n L√Ω ƒê∆°n H√†ng</h1>
                            <div class="bg-white p-4 rounded-lg shadow-md mb-4">
                                <div class="flex flex-wrap gap-x-4 gap-y-2 items-center justify-between">
                                    <div class="flex flex-wrap gap-2 items-center">
                                        <input type="text" id="don-hang-search" placeholder="T√¨m ki·∫øm chung..." class="px-3 py-2 border rounded-md w-40">
                                        <div class="flex items-center gap-2">
                                            <label for="don-hang-filter-from-date" class="text-sm">T·ª´:</label>
                                            <input type="date" id="don-hang-filter-from-date" class="px-3 py-1.5 border rounded-md">
                                            <label for="don-hang-filter-to-date" class="text-sm">ƒê·∫øn:</label>
                                            <input type="date" id="don-hang-filter-to-date" class="px-3 py-1.5 border rounded-md">
                                        </div>
                                        <div class="relative"><button id="don-hang-filter-loai-btn" data-filter-key="loai" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">Lo·∫°i</button></div>
                                        <div class="relative"><button id="don-hang-filter-trang-thai-btn" data-filter-key="trang_thai_xu_ly" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-36">Tr·∫°ng Th√°i</button></div>
                                        <div class="relative"><button id="don-hang-filter-ma-kho-btn" data-filter-key="ma_kho" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">M√£ Kho</button></div>
                                        <div class="relative"><button id="don-hang-filter-ma-nx-btn" data-filter-key="ma_nx" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">M√£ NX</button></div>
                                        <div class="relative"><button id="don-hang-filter-yeu-cau-btn" data-filter-key="yeu_cau" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">Y√™u C·∫ßu</button></div>
                                        <div class="relative"><button id="don-hang-filter-nganh-btn" data-filter-key="nganh" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">Ng√†nh</button></div>
                                    </div>
                                    <div class="flex flex-wrap gap-2 items-center">
                                        <button id="don-hang-reset-filters" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md">X√≥a L·ªçc</button>
                                        <button id="don-hang-btn-add" class="dh-admin-only bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">+ Th√™m</button>
                                        <button id="don-hang-btn-edit" class="dh-admin-only bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-4 rounded-md" disabled>S·ª≠a</button>
                                        <button id="don-hang-btn-delete" class="dh-admin-only bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md" disabled>X√≥a</button>
                                        <button id="don-hang-btn-print" class="flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md" disabled>
                                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm7-14a2 2 0 100-4 2 2 0 000 4z"></path></svg>
                                            In
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-grow bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="table-container">
                                <table class="min-w-full border-collapse">
                                    <thead class="bg-gray-200"><tr>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;"><input type="checkbox" id="don-hang-select-all"></th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">M√£ Kho</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">Th·ªùi Gian</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">M√£ NX</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">Y√™u C·∫ßu</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 7%;">Ng√†nh</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 30%;">M·ª•c ƒê√≠ch</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 20%;">Ghi Ch√∫</th>
                                        <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">File</th>
                                    </tr></thead>
                                    <tbody id="don-hang-table-body" class="bg-white"></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="flex-shrink-0 flex flex-col md:flex-row justify-between items-center mt-4 p-4 bg-white rounded-lg shadow-md">
                            <span id="don-hang-pagination-info" class="text-sm text-gray-600 mb-2 md:mb-0"></span>
                            <span id="don-hang-selection-info" class="text-sm text-gray-600 mb-2 md:mb-0"></span>
                            <div class="flex items-center gap-2 flex-wrap">
                                <select id="don-hang-items-per-page" class="px-3 py-1 border rounded-md bg-white">
                                    <option value="50">50 / trang</option>
                                    <option value="100">100 / trang</option>
                                    <option value="200">200 / trang</option>
                                    <option value="500">500 / trang</option>
                                </select>
                                <button id="don-hang-prev-page" class="px-3 py-1 border rounded-md bg-white">Tr∆∞·ªõc</button>
                                <div class="flex items-center gap-1 mx-2">
                                    <span class="text-sm text-gray-700">Trang</span>
                                    <input type="number" id="don-hang-page-input" class="w-16 text-center border rounded-md p-1 text-sm" value="1" min="1">
                                    <span id="don-hang-total-pages" class="text-sm text-gray-700 whitespace-nowrap">/ 1</span>
                                </div>
                                <button id="don-hang-next-page" class="px-3 py-1 border rounded-md bg-white">Sau</button>
                            </div>
                        </div>
                    </div>

                    <div id="view-chi-tiet" class="app-view hidden flex flex-col h-full">
                        <div class="flex-shrink-0">
                            <h1 class="text-2xl md:text-3xl font-bold text-gray-800 mb-4">Chi Ti·∫øt Giao D·ªãch</h1>
                            <div class="bg-white p-4 rounded-lg shadow-md mb-4">
                                <div class="flex flex-wrap gap-x-4 gap-y-2 items-center justify-between">
                                    <div class="flex flex-wrap gap-2 items-center">
                                        <input type="text" id="chi-tiet-search" placeholder="T√¨m ki·∫øm chung..." class="px-3 py-2 border rounded-md w-40">
                                        <div class="flex items-center gap-2">
                                            <label for="chi-tiet-filter-from-date" class="text-sm">T·ª´:</label>
                                            <input type="date" id="chi-tiet-filter-from-date" class="px-3 py-1.5 border rounded-md">
                                            <label for="chi-tiet-filter-to-date" class="text-sm">ƒê·∫øn:</label>
                                            <input type="date" id="chi-tiet-filter-to-date" class="px-3 py-1.5 border rounded-md">
                                        </div>
                                        <div class="relative"><button id="chi-tiet-filter-ma-kho-btn" data-filter-key="ma_kho" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">M√£ Kho</button></div>
                                        <div class="relative"><button id="chi-tiet-filter-ma-nx-btn" data-filter-key="ma_nx" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">M√£ NX</button></div>
                                        <div class="relative"><button id="chi-tiet-filter-ma-vt-btn" data-filter-key="ma_vt" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">M√£ VT</button></div>
                                        <div class="relative"><button id="chi-tiet-filter-lot-btn" data-filter-key="lot" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">LOT</button></div>
                                        <div class="relative"><button id="chi-tiet-filter-nganh-btn" data-filter-key="nganh" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-28">Ng√†nh</button></div>
                                        <div class="relative"><button id="chi-tiet-filter-phu-trach-btn" data-filter-key="phu_trach" class="filter-btn text-left px-3 py-2 border rounded-md bg-white w-32">Ph·ª• Tr√°ch</button></div>
                                    </div>
                                    <div class="flex flex-wrap gap-2 items-center">
                                        <button id="chi-tiet-reset-filters" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md">X√≥a L·ªçc</button>
                                        <button id="chi-tiet-btn-excel" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md">Excel</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-grow bg-white rounded-lg shadow-md overflow-hidden">
                            <div class="table-container">
                                <table class="min-w-full border-collapse">
                                    <thead class="bg-gray-200">
                                        <tr>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 4%;">Th·ªùi Gian</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 6%;">M√£ Kho</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 6%;">M√£ NX</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 10%;">M√£ V·∫°ch</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 6%;">M√£ VT</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 15%;">T√™n VT</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Lot</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Date</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">YCSL</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">
                                                <div>Nh·∫≠p<span id="chi-tiet-header-nhap-count" class="block font-bold text-green-600 text-xs"></span></div>
                                            </th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 3%;">
                                                <div>Xu·∫•t<span id="chi-tiet-header-xuat-count" class="block font-bold text-red-600 text-xs"></span></div>
                                            </th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Lo·∫°i</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Y√™u C·∫ßu</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 18%;">M·ª•c ƒê√≠ch</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Ng√†nh</th>
                                            <th class="px-1 py-3 text-center text-xs font-bold text-black uppercase tracking-wider border border-gray-300" style="width: 5%;">Ph·ª• Tr√°ch</th>
                                        </tr>
                                    </thead>
                                    <tbody id="chi-tiet-table-body" class="bg-white text-xs"></tbody>
                                </table>
                            </div>
                        </div>
                        <div class="flex-shrink-0 flex flex-col md:flex-row justify-between items-center mt-4 p-4 bg-white rounded-lg shadow-md">
                            <span id="chi-tiet-pagination-info" class="text-sm text-gray-600 mb-2 md:mb-0"></span>
                             <span id="chi-tiet-selection-info" class="text-sm text-gray-600 mb-2 md:mb-0"></span>
                            <div class="flex items-center gap-2 flex-wrap">
                                <select id="chi-tiet-items-per-page" class="px-3 py-1 border rounded-md bg-white">
                                    <option value="50">50 / trang</option>
                                    <option value="100">100 / trang</option>
                                    <option value="200">200 / trang</option>
                                    <option value="500">500 / trang</option>
                                </select>
                                <button id="chi-tiet-prev-page" class="px-3 py-1 border rounded-md bg-white">Tr∆∞·ªõc</button>
                                <div class="flex items-center gap-1 mx-2">
                                    <span class="text-sm text-gray-700">Trang</span>
                                    <input type="number" id="chi-tiet-page-input" class="w-16 text-center border rounded-md p-1 text-sm" value="1" min="1">
                                    <span id="chi-tiet-total-pages" class="text-sm text-gray-700 whitespace-nowrap">/ 1</span>
                                </div>
                                <button id="chi-tiet-next-page" class="px-3 py-1 border rounded-md bg-white">Sau</button>
                            </div>
                        </div>
                    </div>
    
                    <div id="view-cai-dat" class="app-view hidden">
                        <!-- Content will be loaded dynamically -->
                    </div>
                </main>
            </div>
        </div>
    </div>
    
    <!-- Modals -->
    <div id="san-pham-modal" class="fixed inset-0 z-50 flex items-center justify-center overflow-auto modal-backdrop hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-lg m-4">
            <form id="san-pham-form" class="p-6">
                <h3 class="text-xl font-semibold leading-6 text-gray-900 mb-4" id="san-pham-modal-title">Th√™m S·∫£n Ph·∫©m M·ªõi</h3>
                <!-- S·ª¨A ID: sp-edit-mode-ma-vt -> san-pham-edit-mode-ma-vt -->
                <input type="hidden" id="san-pham-edit-mode-ma-vt">
                <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                <input type="hidden" id="san-pham-modal-hinh-anh-url-hien-tai">
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">H√¨nh ·∫¢nh S·∫£n Ph·∫©m</label>
                        <div class="flex items-center space-x-4">
                            <!-- S·ª¨A ID: sp-image-paste-area -> san-pham-image-paste-area -->
                            <div id="san-pham-image-paste-area" tabindex="0" class="w-24 h-24 border-2 border-dashed rounded-md flex items-center justify-center cursor-pointer bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                                <img id="san-pham-modal-image-preview" src="" alt="Xem tr∆∞·ªõc" class="w-full h-full object-cover rounded-md pointer-events-none">
                            </div>
                            <div class="flex flex-col space-y-2">
                                <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                                <label for="san-pham-modal-image-upload" class="cursor-pointer bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50">
                                    <span>T·∫£i ·∫£nh l√™n</span>
                                    <input id="san-pham-modal-image-upload" type="file" class="sr-only" accept="image/*">
                                </label>
                                <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                                <button type="button" id="san-pham-modal-remove-image-btn" class="hidden text-sm text-red-600 hover:text-red-800">X√≥a ·∫£nh</button>
                            </div>
                        </div>
                    </div>
                    <div>
                        <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                        <label for="san-pham-modal-ma-vt" class="block text-sm font-medium text-gray-700">M√£ V·∫≠t T∆∞</label>
                        <input type="text" id="san-pham-modal-ma-vt" required class="mt-1 block w-full border rounded-md p-2">
                    </div>
                    <div>
                        <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                        <label for="san-pham-modal-ten-vt" class="block text-sm font-medium text-gray-700">T√™n V·∫≠t T∆∞</label>
                        <input type="text" id="san-pham-modal-ten-vt" required class="mt-1 block w-full border rounded-md p-2">
                    </div>
                    <div>
                        <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                        <label for="san-pham-modal-nganh" class="block text-sm font-medium text-gray-700">Ng√†nh</label>
                        <input type="text" id="san-pham-modal-nganh" class="mt-1 block w-full border rounded-md p-2">
                    </div>
                    <div>
                        <!-- S·ª¨A ID: sp-modal... -> san-pham-modal... -->
                        <label for="san-pham-modal-phu-trach" class="block text-sm font-medium text-gray-700">Ph·ª• Tr√°ch</label>
                        <input type="text" id="san-pham-modal-phu-trach" list="phu-trach-list" class="mt-1 block w-full border rounded-md p-2">
                        <datalist id="phu-trach-list"></datalist>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <!-- S·ª¨A ID: cancel-sp-btn -> cancel-san-pham-btn (Th·ªëng nh·∫•t) -->
                    <button type="button" id="cancel-san-pham-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md">H·ªßy</button>
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">L∆∞u</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="ton-kho-modal" class="fixed inset-0 z-50 flex items-center justify-center overflow-auto modal-backdrop hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-4xl m-4">
            <form id="ton-kho-form" class="p-6 max-h-[90vh] overflow-y-auto">
                <div class="flex justify-between items-start mb-4">
                    <div>
                         <h3 class="text-xl font-semibold leading-6 text-gray-900" id="ton-kho-modal-title">Th√™m T·ªìn Kho M·ªõi</h3>
                         <div id="ton-kho-modal-ma-vach-display-container" class="text-sm mt-1">
                             M√£ v·∫°ch: <span id="ton-kho-modal-ma-vach-display" class="font-mono font-bold"></span>
                             <span id="ton-kho-modal-ma-vach-status" class="ml-2 text-xs"></span>
                         </div>
                    </div>
                </div>

                <input type="hidden" id="ton-kho-edit-mode-ma-vach">
                <input type="hidden" id="ton-kho-modal-ma-vach"> 
                
                <div class="space-y-4">
                    <!-- H√†ng 1 -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="relative">
                            <label for="ton-kho-modal-ma-vt" class="block text-sm font-medium text-gray-700">M√£ VT <span class="text-red-500">*</span></label>
                            <input type="text" id="ton-kho-modal-ma-vt" required autocomplete="off" class="mt-1 block w-full border rounded-md p-2">
                        </div>
                        <div class="md:col-span-2">
                            <label for="ton-kho-modal-ten-vt" class="block text-sm font-medium text-gray-700">T√™n VT</label>
                            <input type="text" id="ton-kho-modal-ten-vt" readonly class="mt-1 block w-full border rounded-md p-2 bg-gray-200 cursor-not-allowed">
                        </div>
                    </div>

                    <!-- H√†ng 2 -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div>
                            <label for="ton-kho-modal-lot" class="block text-sm font-medium text-gray-700">Lot</label>
                            <input type="text" id="ton-kho-modal-lot" class="mt-1 block w-full border rounded-md p-2">
                        </div>
                        <div>
                            <label for="ton-kho-modal-date" class="block text-sm font-medium text-gray-700">Date</label>
                            <input type="text" id="ton-kho-modal-date" placeholder="dd/mm/yyyy" class="mt-1 block w-full border rounded-md p-2">
                        </div>
                        <div>
                            <label for="ton-kho-modal-tinh-trang" class="block text-sm font-medium text-gray-700">T√¨nh Tr·∫°ng <span class="text-red-500">*</span></label>
                             <div id="ton-kho-modal-tinh-trang-container" class="mt-1">
                                <input type="text" id="ton-kho-modal-tinh-trang" required class="block w-full border rounded-md p-2">
                            </div>
                        </div>
                    </div>
                    
                    <!-- H√†ng 3 -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <div>
                            <label for="ton-kho-modal-ton-dau" class="block text-sm font-medium text-gray-700">T·ªìn ƒê·∫ßu <span class="text-red-500">*</span></label>
                            <input type="number" id="ton-kho-modal-ton-dau" value="0" class="mt-1 block w-full border rounded-md p-2">
                        </div>
                        <div>
                            <label for="ton-kho-modal-tray" class="block text-sm font-medium text-gray-700">Tray</label>
                            <input type="text" id="ton-kho-modal-tray" class="mt-1 block w-full border rounded-md p-2">
                        </div>
                        <div>
                            <label for="ton-kho-modal-nganh" class="block text-sm font-medium text-gray-700">Ng√†nh</label>
                            <input type="text" id="ton-kho-modal-nganh" readonly class="mt-1 block w-full border rounded-md p-2 bg-gray-200 cursor-not-allowed">
                        </div>
                        <div>
                            <label for="ton-kho-modal-phu-trach" class="block text-sm font-medium text-gray-700">Ph·ª• Tr√°ch</label>
                            <input type="text" id="ton-kho-modal-phu-trach" readonly list="phu-trach-list" class="mt-1 block w-full border rounded-md p-2 bg-gray-200 cursor-not-allowed">
                        </div>
                    </div>
                    
                    <!-- H√†ng ·∫©n -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 hidden">
                         <div><label for="ton-kho-modal-nhap" class="block text-sm font-medium text-gray-700">Nh·∫≠p</label><input type="number" id="ton-kho-modal-nhap" value="0" class="mt-1 block w-full border rounded-md p-2"></div>
                         <div><label for="ton-kho-modal-xuat" class="block text-sm font-medium text-gray-700">Xu·∫•t</label><input type="number" id="ton-kho-modal-xuat" value="0" class="mt-1 block w-full border rounded-md p-2"></div>
                    </div>
                    
                    <!-- H√†ng 4 -->
                    <div>
                        <label for="ton-kho-modal-note" class="block text-sm font-medium text-gray-700">Note</label>
                        <textarea id="ton-kho-modal-note" rows="3" class="mt-1 block w-full border rounded-md p-2"></textarea>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" id="cancel-ton-kho-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md">H·ªßy</button>
                    <button type="submit" id="save-ton-kho-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">L∆∞u</button>
                    <button type="button" id="close-ton-kho-view-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md hidden">ƒê√≥ng</button>
                </div>
            </form>
        </div>
    </div>

    <div id="don-hang-modal" class="fixed inset-0 z-50 flex items-center justify-center overflow-auto modal-backdrop hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-[95vw] m-4 max-h-[95vh] flex flex-col">
            <form id="don-hang-form" class="flex flex-col flex-grow contents">
                <div class="p-3 border-b flex-shrink-0">
                    <h3 class="text-xl font-semibold leading-6 text-gray-900" id="don-hang-modal-title">Th√™m ƒê∆°n H√†ng M·ªõi</h3>
                </div>
                <div class="flex-grow overflow-y-auto p-3">
                    <input type="hidden" id="don-hang-edit-mode-ma-kho">
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-3">
                        <div class="lg:col-span-1 space-y-3">
                            <div class="bg-gray-50 p-3 rounded-lg border h-full flex flex-col">
                                <h4 class="font-semibold text-gray-800 mb-2">Th√¥ng Tin Chung</h4>
                                <div class="flex-grow space-y-3">
                                    <!-- H√†ng 1 -->
                                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                                        <div>
                                            <label for="don-hang-modal-thoi-gian" class="block text-sm font-medium text-gray-700">Th·ªùi Gian <span class="text-red-500">*</span></label>
                                            <input type="date" id="don-hang-modal-thoi-gian" required class="mt-1 block w-full border rounded-md p-2">
                                        </div>
                                        <div>
                                            <label for="don-hang-modal-loai-don" class="block text-sm font-medium text-gray-700">Lo·∫°i ƒê∆°n <span class="text-red-500">*</span></label>
                                            <select id="don-hang-modal-loai-don" required class="mt-1 block w-full border rounded-md p-2">
                                                <option value="" disabled selected>-- Ch·ªçn Lo·∫°i ƒê∆°n --</option>
                                                <option value="Xuat">Xu·∫•t</option>
                                                <option value="Nhap">Nh·∫≠p</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label for="don-hang-modal-yeu-cau" class="block text-sm font-medium text-gray-700">Y√™u C·∫ßu <span class="text-red-500">*</span></label>
                                            <input type="text" id="don-hang-modal-yeu-cau" required class="mt-1 block w-full border rounded-md p-2">
                                        </div>
                                    </div>
                                    <!-- H√†ng 2 -->
                                    <div class="grid grid-cols-1 sm:grid-cols-3 gap-3">
                                        <div>
                                            <label for="don-hang-modal-nganh" class="block text-sm font-medium text-gray-700">Ng√†nh <span class="text-red-500">*</span></label>
                                            <input type="text" id="don-hang-modal-nganh" list="nganh-list" required class="mt-1 block w-full border rounded-md p-2">
                                            <datalist id="nganh-list"></datalist>
                                        </div>
                                        <div>
                                            <label for="don-hang-modal-ma-kho" class="block text-sm font-medium text-gray-700">M√£ Kho</label>
                                            <input type="text" id="don-hang-modal-ma-kho" readonly class="mt-1 block w-full border rounded-md p-2 bg-gray-200 cursor-not-allowed">
                                        </div>
                                        <div>
                                            <label for="don-hang-modal-ma-nx" class="block text-sm font-medium text-gray-700">M√£ NX <span class="text-red-500">*</span></label>
                                            <input type="text" id="don-hang-modal-ma-nx" required class="mt-1 block w-full border rounded-md p-2">
                                        </div>
                                    </div>
                                    <!-- H√†ng 3 - M·ª•c ƒë√≠ch & Ghi ch√∫ -->
                                     <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                        <div>
                                            <label for="don-hang-modal-muc-dich" class="block text-sm font-medium text-gray-700">M·ª•c ƒê√≠ch <span class="text-red-500">*</span></label>
                                            <textarea id="don-hang-modal-muc-dich" rows="4" required class="mt-1 block w-full border rounded-md p-2"></textarea>
                                        </div>
                                        <div>
                                            <label for="don-hang-modal-ghi-chu" class="block text-sm font-medium text-gray-700">Ghi Ch√∫</label>
                                            <textarea id="don-hang-modal-ghi-chu" rows="4" class="mt-1 block w-full border rounded-md p-2"></textarea>
                                        </div>
                                    </div>
                                    <!-- H√†ng 4 - File ƒë√≠nh k√®m -->
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">File ƒë√≠nh k√®m</label>
                                        <div class="flex items-start gap-3">
                                            <div id="don-hang-file-drop-area" class="flex flex-col items-center justify-center rounded-md border-2 border-dashed border-gray-300 p-2 text-center h-28 w-28 flex-shrink-0">
                                                <svg class="mx-auto h-6 w-6 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true"><path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
                                                <label for="don-hang-file-upload" class="relative cursor-pointer rounded-md bg-white font-medium text-indigo-600 hover:text-indigo-500 text-sm"><span>T·∫£i t·ªáp</span><input id="don-hang-file-upload" type="file" class="sr-only" multiple=""></label>
                                                <p class="text-xs text-gray-500 mt-1">k√©o/th·∫£/d√°n</p>
                                            </div>
                                            <div id="don-hang-file-list" class="space-y-2 w-full" style="max-height: 112px; overflow-y: auto;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="lg:col-span-2">
                            <div class="bg-gray-50 p-3 rounded-lg border h-full flex flex-col">
                                <div class="flex-shrink-0">
                                    <div class="flex justify-between items-center mb-2">
                                        <h4 class="font-semibold text-gray-800 flex-1 text-left">Danh S√°ch V·∫≠t T∆∞</h4>
                                        <div id="don-hang-chi-tiet-summary" class="text-sm text-gray-700 font-medium h-5 flex-1 text-center"></div>
                                        <div class="flex-1 text-right">
                                            <button type="button" id="don-hang-them-vat-tu-btn" class="bg-green-500 hover:bg-green-600 text-white font-bold py-1 px-3 rounded-md text-sm">+ Th√™m V·∫≠t T∆∞</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="flex-grow overflow-y-auto" style="max-height: 60vh;">
                                    <table class="w-full text-sm text-left">
                                        <thead class="bg-gray-200">
                                            <tr>
                                                <th style="width: 3%;" class="p-2 border sticky top-0 z-10 bg-gray-200">STT</th>
                                                <th style="width: 12%;" class="p-2 border sticky top-0 z-10 bg-gray-200">M√£ VT <span class="text-red-500">*</span></th>
                                                <th style="width: 25%;" class="p-2 border sticky top-0 z-10 bg-gray-200">T√™n VT</th>
                                                <th style="width: 10%;" class="p-2 border sticky top-0 z-10 bg-gray-200">LOT</th>
                                                <th style="width: 10%;" class="p-2 border sticky top-0 z-10 bg-gray-200">Date</th>
                                                <th style="width: 5%;" class="p-2 border sticky top-0 z-10 bg-gray-200">Y/c <span class="text-red-500">*</span></th>
                                                <th style="width: 5%;" class="p-2 border sticky top-0 z-10 bg-gray-200" id="don-hang-sl-header">SL <span class="text-red-500">*</span></th>
                                                <th style="width: 10%;" class="p-2 border sticky top-0 z-10 bg-gray-200">Lo·∫°i <span class="text-red-500">*</span></th>
                                                <th style="width: 15%;" class="p-2 border sticky top-0 z-10 bg-gray-200">M√£ V·∫°ch</th>
                                                <th style="width: 5%;" class="p-2 border sticky top-0 z-10 bg-gray-200">X√≥a</th>
                                            </tr>
                                        </thead>
                                        <tbody id="don-hang-chi-tiet-body" class="bg-white">
                                            <!-- Rows will be added dynamically -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="p-3 border-t flex-shrink-0 flex justify-end space-x-3">
                    <button type="button" id="cancel-don-hang-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md">H·ªßy</button>
                    <button type="submit" id="save-don-hang-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">L∆∞u</button>
                    <button type="button" id="close-don-hang-view-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md hidden">ƒê√≥ng</button>
                </div>
            </form>
        </div>
    </div>

    <div id="password-reset-modal" class="fixed inset-0 z-50 flex items-center justify-center overflow-auto modal-backdrop hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4 p-6"><h3 class="text-lg font-medium leading-6 text-gray-900 mb-4">ƒê·∫∑t l·∫°i m·∫≠t kh·∫©u</h3><form id="password-reset-form"><input type="hidden" id="reset-user-gmail"><p class="mb-2 text-sm text-gray-700">B·∫°n ƒëang ƒë·∫∑t l·∫°i m·∫≠t kh·∫©u cho: <strong id="reset-user-gmail-display"></strong></p><div><label for="reset-new-password" class="block text-sm font-medium text-gray-700">M·∫≠t kh·∫©u m·ªõi</label><input type="password" id="reset-new-password" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"></div><div class="mt-6 flex justify-end space-x-3"><button type="button" id="cancel-reset-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md">H·ªßy</button><button type="submit" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md">ƒê·∫∑t l·∫°i</button></div></form></div>
    </div>
    
    <div id="confirm-modal" class="fixed inset-0 z-[60] flex items-center justify-center modal-backdrop hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-md m-4 p-6">
            <h3 id="confirm-title" class="text-lg font-medium leading-6 text-gray-900 mb-2">X√°c nh·∫≠n h√†nh ƒë·ªông</h3>
            <p id="confirm-message" class="text-sm text-gray-600 mb-4">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?</p>
            <div class="mt-6 flex justify-end space-x-3">
                <button id="confirm-cancel-btn" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md">H·ªßy</button>
                <button id="confirm-ok-btn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md">X√°c nh·∫≠n</button>
            </div>
        </div>
    </div>

    <div id="excel-export-modal" class="fixed inset-0 z-[60] flex items-center justify-center modal-backdrop hidden">
        <div class="bg-white rounded-lg shadow-xl w-full max-w-sm m-4 p-6">
            <h3 class="text-lg font-medium leading-6 text-gray-900 mb-4">T√πy ch·ªçn xu·∫•t Excel</h3>
            <p class="text-sm text-gray-600 mb-6">Ch·ªçn lo·∫°i d·ªØ li·ªáu b·∫°n mu·ªën xu·∫•t ra file Excel.</p>
            <div class="flex flex-col space-y-3">
                <button id="excel-export-filtered-btn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">Xu·∫•t theo b·ªô l·ªçc</button>
                <button id="excel-export-all-btn" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-md">Xu·∫•t to√†n b·ªô</button>
                 <button id="excel-export-cancel-btn" class="w-full mt-4 bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-md">H·ªßy</button>
            </div>
        </div>
    </div>

    <div id="image-viewer-modal" class="fixed inset-0 z-[60] flex items-center justify-center modal-backdrop hidden">
        <div class="relative bg-white rounded-lg shadow-xl m-4 p-4">
            <button id="close-image-viewer-btn" class="absolute -top-3 -right-3 bg-red-600 text-white rounded-full p-1.5 focus:outline-none hover:bg-red-700 z-10">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
            </button>
            <img id="image-viewer-img" src="" alt="H√¨nh ·∫£nh s·∫£n ph·∫©m" class="max-w-[80vw] max-h-[80vh] object-contain">
        </div>
    </div>
    
    <div id="filter-popover-template" class="filter-popover hidden">
        <input type="text" class="filter-search-input w-full px-2 py-1 border rounded-md" placeholder="T√¨m ki·∫øm...">
        <div class="filter-options-list space-y-1 p-1"></div>
        <div class="text-right mt-2">
            <button class="filter-apply-btn bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold py-1 px-3 rounded-md">√Åp d·ª•ng</button>
        </div>
    </div>

    <div id="autocomplete-popover-template" class="absolute z-50 mt-1 bg-white border border-gray-300 rounded-md shadow-lg hidden w-full">
        <div class="autocomplete-options-list max-h-48 overflow-y-auto">
            <!-- Autocomplete options are rendered here by JavaScript -->
        </div>
    </div>

    <!-- Overlays -->
    <div id="app-loading" class="flex items-center justify-center min-h-screen">
        <p class="text-gray-600 text-lg">ƒêang ki·ªÉm tra phi√™n ƒëƒÉng nh·∫≠p...</p>
    </div>

    <script type="module" src="app.js"></script>
</body>
</html>